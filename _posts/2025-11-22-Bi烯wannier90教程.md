---
layout: post
title: "以Bi烯为例的wannier90表面态计算"
subtitle: "Experience Sharing"
background: '/img/bg-sci-note.jpg'
categories: sci-note
permalink: /sci-note_posts/20251121-Bi
---

## <center>心得笔记</center>

-免责声明：私人笔记-不传播
-原作者示例来源于公众号“计算凝聚态物理”，本笔记是用于学习、复现此公众号中的教程，并记录本人遇到的问题和步骤以及心得体会，如在互联网上检索到本文章，请勿用作他途。

注意，安装6.3.0版本以上的vasp，不包含6.3.0的vasp，并且编译的时候不要注释掉并行计算，wannier3.1.0版本是支持并行计算的，如果注释掉的话，会报错。

### 1.能带计算

计算得到BAND.dat，KLABELS，查看能带中的轨道贡献，通过投影能带，我们需要投影Bi原子的p轨道，原胞有两个原子，每个原子6个p轨道，我们需要拟合12个wannier轨道。

<img src="/img/以Bi烯为例的wannier90表面态计算/bg-b2.png" style="width:100%; margin-bottom:5px;">

<img src="/img/以Bi烯为例的wannier90表面态计算/bg-b3.png" style="width:100%; margin-bottom:5px;">



### 2.静态自洽计算（注意添加LWANNIER90=.T）


准备文件
<img src="/img/以Bi烯为例的wannier90表面态计算/bg-b1.png" style="width:100%; margin-bottom:5px;">

win文件内容：

```shell

num_wann =    64  ! set to NBANDS by VASP
kmesh_tol=0.00001

```
NBANDS =64 (这个数值是你的CPU数量的整数倍，我是用 64 核提交的)，INCAR中加入LWANNIER90=T

INCAR文件内容：

```shell


SYSTEM = Bi
ISTART =      0 
LCHARG = .T.
IVDW=11
ISYM=0
LSORBIT = .TRUE.
SAXIS =  0  0  1  
MAGMOM = 6*0
GGA_COMPAT=.FALSE.

NELM   =    2000
NELMIN =   5
EDIFFG = -0.001
EDIFF  = 1E-08
PREC   =  A
NSW    = 0 
IBRION = -1 
POTIM  =  0.5
ENCUT  = 520

ISMEAR = -5
EMIN=-15
EMAX=15
LORBIT=11
NEDOS=3000
ALGO  =  N
LREAL =  F
LWANNIER90 = T
ICHARG= 1
NBANDS=64

```
### 3.vasp非自洽计算，拟合Wannier90

win文件中加入，同时修改ICHGCAR=11
```shell
num_wann  = 12
exclude_bands:1-2

kmesh_tol=0.00001

dis_win_min=-7.2
dis_win_max=3.5
dis_froz_min=-7.2
dis_froz_max=1.45

begin projections
Bi:p
end projections

guiding_centres = true
```

这个步骤需要反复调试能量窗口，如果成功的话，会产生新的文件。wannier90.amn, wannier90.eig, wannier90.mmn, wannier90.win, wannier90.wout

### 4. Wannier90计算

修改wannier90.win,上一步基础上，增加

```shell
write_hr = true
bands_plot = true
bands_num_points = 20
bands_plot_format = gnuplot

begin kpoint_path
G 0.00000  0.00000 0.0000 M 0.50000  0.00000 0.0000
M 0.50000  0.00000 0.0000 K 0.33333  0.33333 0.0000
K 0.33333  0.33333 0.0000 G 0.00000  0.00000 0.0000
end kpoint_path

```

这里bands_num_points = 20 跟 VASPKIT 中能带计算的KPOINTS中 K 点数要相同（如下 KPOINTS的前三行，第二行中 K 点密度是 20，这么做是为了方便对比 VASP 和 wannier90 的能带）

提交wannier90的计算：

```shell

wannier90.x wannier90 &

```

### 5.对比vasp和Wannier90的能带

找到能带计算的费米能级：

```shell

grep E-fermi OUTCAR

```

查看费米能级后，将能带计算的BAND.dat和KLABELS放到wannier90计算的文件夹中，修改compare_wan_vasp.py中的efermi，然后运行。

### 6.WannierTools 计算边缘态和陈数

#### (1) 边缘态

以 zig-zag方向为例，展示计算得到的边界态 参照 wannier90.win 中的信息，修改wannierTools 的输入文件 wt.in：

```shell

&TB_FILE
Hrfile = 'wannier90_hr.dat'  ! 紧束缚模型文件
Package = 'VASP'             ! 使用VASP软件包
/

&CONTROL
BulkBand_calc         = F    ! 不计算体材料能带
SlabSS_calc           = T    ! 计算表面谱函数
Z2_3D_calc            = F    ! 不计算3D Z2拓扑不变量
/

&SYSTEM
SOC = 1                 ! 自旋轨道耦合
E_FERMI = -0.6465       ! 费米能级
Numoccupied = 6         ! 占据态数目
/

&PARAMETERS
Eta_Arc = 0.001     ! 无穷小量，用于展宽
E_arc =-0.05        ! 计算费米弧的能量
OmegaMin = -1.3     ! 能量范围最小值，用于能带绘图
OmegaMax =  1.3     ! 能量范围最大值，用于能带绘图
OmegaNum = 401      ! 能量点数，能带绘图步长
Nk1 = 101           ! k点数量（奇数更佳）
Nk2 = 101           ! k点数量（奇数更佳）
Np  = 2             ! k点数量（奇数更佳）
/

SURFACE                  ! 表面定义（锯齿形方向）
 1  0  0                 ! 表面法向量
 0  0  1                 ! 第二个基矢
 0  1  0                 ! 第三个基矢

KPATH_BULK               ! 体材料k点路径
3                        ! k路径段数（仅用于体材料能带）
G 0.00000  0.00000 0.0000 M 0.50000  0.00000 0.0000  ! Γ到M点
M 0.50000  0.00000 0.0000 K 0.33333  0.33333 0.0000  ! M到K点
K 0.33333  0.33333 0.0000 G 0.00000  0.00000 0.0000  ! K到Γ点

KPATH_SLAB               ! 薄膜k点路径
2                        ! k路径段数（用于二维情况）
X  0.5  0.0 G  0.0  0.0  ! X到Γ点（二维情况k路径）
G  0.0  0.0 X  0.5  0.0  ! Γ到X点

LATTICE                  ! 晶格参数
Angstrom                 ! 单位：埃
     2.1017795    -3.6403930     0.0000000  ! 晶格矢量a
     2.1017795     3.6403930     0.0000000  ! 晶格矢量b
     0.0000000     0.0000000    15.0000000  ! 晶格矢量c

ATOM_POSITIONS           ! 原子位置
2                        ! 投影原子数目
Cartisen                 ! 笛卡尔坐标
Bi       2.1017795     1.2134643    10.7681236  ! 铋原子位置1
Bi       2.1017795    -1.2134643     9.0367958   ! 铋原子位置2

PROJECTORS               ! 投影子设置
3 3                      ! 每个原子的投影轨道数
Bi pz px py              ! 铋原子1的轨道：pz, px, py
Bi pz px py              ! 铋原子2的轨道：pz, px, py

!WANNIER_CENTRES         ! 从wannier90.wout复制
!Cartesian               ! 笛卡尔坐标

```

运行WannierTools:

```shell

wt.x 

```

运行完后绘图：

```

gnuplot *.gnu

```


<img src="/img/以Bi烯为例的wannier90表面态计算/bg-b4.png" style="width:100%; margin-bottom:5px;">

我复现的边缘态：

<img src="/img/以Bi烯为例的wannier90表面态计算/bg-b5.png" style="width:100%; margin-bottom:5px;">