---
layout: post
title: "vasp计算投影能带"
subtitle: "Experience Sharing"
background: '/img/bg-sci-note.jpg'
categories: sci-note
permalink: /sci-note_posts/20250924-pbands/
---

## <center>Vasp计算DOS</center>

　　投影能带的计算不是必需的，而是在分析机制的时候使用。例如在分析晶体场劈裂情况时需要用到。使用名称为《vasp计算能带》文章中所用的INCAR，计算完成后，输入vaspkit/214 即可输出手动选择特定原子的投影能带数据文件。下面是vaspkit投影能带的选取注释：

211    标准能带结构（包含所有原子和轨道的投影）

212    仅提取单个选定原子的轨道投影能带

213    按元素分类（如所有 Fe 原子）的投影能带

214    手动选择特定原子（输入原子序号）的投影能带

215    按元素权重（如 50% Fe + 50% O）的投影能带

216    对选定原子和轨道的投影求和（如所有 Fe 的 d 轨道）


**<span style="font-size: 120%"> 1.Origin绘图（重点）</span>**

以MPSS为例，其结构如图所示

<div align="center"><img src="/img/vasp计算能带/bg-s1.png" alt="MPSS结构图" style="width:500px; height:auto;"/></div>
<div align="center"><img src="/img/vasp计算能带/bg-s2.png" alt="MPSS结构图" style="width:500px; height:auto;"/></div>

vaspkit/214/Mo，绘制Mo原子的投影能带

<div align="center"><img src="/img/vasp计算投影能带/bg-b1.png" alt="第一步" style="width:500px; height:auto;"/></div>

如上图所示，得到数据文件PBAND_SUM_DW.dat和PBAND_SUM_UP.dat文件。删除上图中选中的两行，便于在origin中直接作为标签。

如下图所示，直接将数据文件拖到origin中：

<div align="center"><img src="/img/vasp计算投影能带/bg-b2.png" alt="第一步" style="width:500px; height:auto;"/></div>

选中如图所示两行画图，如下图所示
<div align="center"><img src="/img/vasp计算投影能带/bg-b3.png" alt="b3" style="width:500px; height:auto;"/></div>

双击1，进入图层，选中十个新添加的图层，点击2成组，点击3，修改成散点图

<div align="center"><img src="/img/vasp计算投影能带/bg-b4.png" alt="b3" style="width:500px; height:auto;"/></div>

双击图像（红框区域），弹出来对话框

<div align="center"><img src="/img/vasp计算投影能带/bg-b5.png" alt="b3" style="width:500px; height:auto;"/></div>

修改如下图所示的三个参数，缩放因子建议20。

<div align="center"><img src="/img/vasp计算投影能带/bg-b6.png" alt="b3" style="width:500px; height:auto;"/></div>

注意事项——反铁磁基态，可以任意选择能量折线图，而铁磁基态，由于能带spin up和spin down不简并，所以绘图时要注意，Energy折线图up要选5个（d轨道，p轨道选3个），down要选五个。

原因是投影能带是算的每个轨道相比于Energy的权重，而反铁磁基态的能量是简并的，所以选up和down的均可，不影响权重计算，而铁磁基态由于作为分母的总能量不简并，所以若想准确计算权重，能量折线图（分母）必须一半up一半down。

最终效果图：

<div align="center"><img src="/img/vasp计算投影能带/bg-b7.png" alt="b3" style="width:500px; height:auto;"/></div>


**<span style="font-size: 120%"> 2.自定义脚本绘图（原创）</span>**

这是一个功能强大的，方便自定义任何参数的，类似于vaspkit的脚本，首先要求你的目录结构如下：

```python
你的工作目录/
├── bands/                    # 能带计算目录 (当前运行脚本的目录)
│   ├── KPOINTS              # 能带路径文件 (包含高对称点)
│   ├── POSCAR -> ../POSCAR  # [推荐] 链接到结构文件
│   ├── POTCAR -> ../POTCAR  # [推荐] 链接到赝势文件
│   ├── INCAR                # 能带计算INCAR (ICHARG=11)
│   ├── vasprun.xml          # 能带计算输出
│   ├── PROCAR               # 能带计算投影输出
│   └── plot_fatbands.py     # 脚本文件 (在这里运行)
│
├── dos/                     # DOS计算目录
│   ├── KPOINTS             # DOS K点文件 (通常更密集)
│   ├── POSCAR -> ../POSCAR
│   ├── POTCAR -> ../POTCAR
│   ├── INCAR               # DOS计算INCAR (LORBIT=11)
│   └── vasprun.xml         # DOS计算输出
│
├── POSCAR                  # 晶体结构文件
└── POTCAR                  # 赝势文件 (由所有原子的POTCAR拼接)

```

代码如下：

```python
