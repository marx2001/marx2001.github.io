---
layout: post
title: "kp构造对称哈密顿量的测试"
subtitle: "Experience Sharing"
background: '/img/bg-sci-note.jpg'
categories: sci-note
permalink: /sci-note_posts/20251206-kp
---


# <center>Recording​</center>


### 1. 步骤

1. 学习代码：
```shell

#!/usr/bin/env python
# -*- coding: utf-8 -*-

# © 2017-2018, ETH Zurich, Institut für Theoretische Physik
# Author:  Dominik Gresch <greschd@gmx.ch>

# 导入必要的库
import sympy as sp
from sympy.core.numbers import I
import sympy.physics.matrices as sm
from sympy.physics.quantum import TensorProduct
import symmetry_representation as sr  # 对称性表示库

import kdotp_symmetry as kp  # k·p 理论对称性处理库

# 在此项目中，我们使用泡利矩阵的张量积作为基矢
# 泡利矩阵向量：单位矩阵 + 三个泡利矩阵
pauli_vec = [sp.eye(2), *(sm.msigma(i) for i in range(1, 4))]
# 创建基矢：所有可能的泡利矩阵两两张量积
basis = [TensorProduct(p1, p2) for p1 in pauli_vec for p2 in pauli_vec]

# 创建对称性操作对象
# C2y 操作：绕特定轴的二重旋转
c2y = sr.SymmetryOperation(
    rotation_matrix=[[0, 1, 0], [1, 0, 0], [0, 0, -1]],  # 空间旋转矩阵
    repr_matrix=sp.diag(I, -I, I, -I),  # 表示矩阵（4x4对角矩阵）
    repr_has_cc=False,  # 表示矩阵不包含复共轭操作
    numeric=False  # 使用符号计算而非数值计算
)

# 宇称操作：空间反演
parity = sr.SymmetryOperation(
    rotation_matrix=-sp.eye(3),  # 负单位矩阵，表示空间反演
    repr_matrix=sp.diag(1, 1, -1, -1),  # 对角表示矩阵
    repr_has_cc=False,  # 不包含复共轭
)

# 时间反演对称性
time_reversal = sr.SymmetryOperation(
    rotation_matrix=sp.eye(3),  # 空间上不旋转
    repr_matrix=TensorProduct(sp.eye(2), sp.Matrix([[0, -1], [1, 0]])),  # 张量积形式的表示矩阵
    repr_has_cc=True,  # 时间反演包含复共轭操作
)


def print_result(order):
    """打印给定k阶数的对称哈密顿量基矢"""
    print('Order:', order)  # 输出当前阶数
    
    # 生成对称哈密顿量并遍历输出
    for m in kp.symmetric_hamiltonian(
        c2y,  # 传入C2y对称性
        parity,  # 传入宇称对称性
        time_reversal,  # 传入时间反演对称性
        expr_basis=kp.monomial_basis(order),  # 使用单项式基矢，阶数为order
        repr_basis=basis  # 使用之前定义的泡利矩阵张量积基矢
    ):
        print(m)  # 打印每个对称的哈密顿量矩阵
    print()  # 空行分隔


if __name__ == '__main__':
    # 主程序：计算并打印0阶、1阶、2阶的对称哈密顿量
    for i in range(3):
        print_result(order=i)

```