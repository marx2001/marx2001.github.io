---
layout: post
title: "以Bi烯为例的wannier90表面态计算"
subtitle: "Experience Sharing"
background: '/img/bg-sci-note.jpg'
categories: sci-note
permalink: /sci-note_posts/20251125-wannier90-mrx
---

## <center>我的一些问题——AI回答，谨慎甄别</center>

AI引擎：Chatgpt-5.1 Auto决定回答时长

Q1：什么是wannier90?

A1：  Wannier90 是一个在计算材料科学和凝聚态物理中非常重要的软件包，用于构造 Maximally Localized Wannier Functions（MLWFs，最大局域化的Wannier函数）。它是第一性原理计算中连接 电子能带结构 与 实空间局域化电子态 的关键工具。
     固体物理中，电子波函数通常以Bloch波函数的形式表示，适用于周期性晶体。但bloch函数是在动量空间局域，实空间扩展，不适合描述化学键或者局域电子特性。

     Wannier函数相反，它是实空间局域化的波函数。

     Wannier90是一个独立的后处理程序，可以从多种第一性原理计算程序，导入计算结果，构造Wannier函数。

Q2：具体应用？

A1：拓扑绝缘体与陈绝缘体分析、电输运与自旋输运、光学响应与Berry相计算、紧束缚模型参数提取、分子吸附、磁性、超导配对分析


## 表面态相关疑问

Q1：拓扑绝缘体、高阶拓扑绝缘体以及表面态都是什么？

A1：拓扑绝缘体是一类内部（体）为绝缘体、表面为导体的量子态。其本质是：能带结构具有非平庸拓扑性质（即，无法连续变形为普通绝缘体），由 拓扑不变量（如 𝑍2、Chern数）区分。电子结构特征：体态
（bulk）：具有能隙（如普通绝缘体）；表面态（surface state）：存在受保护的导电态；能带倒转（band inversion）：由于强自旋轨道耦合（SOC），价带与导带在能量序上“翻转”，产生拓扑非平庸结构。可以理
解为：“内部像绝缘体，表皮却像金属。”

Q2：为什么计算二维体系的表面态，要计算bulk 能带呢？二维体系的是否具有不同面？（wt.in文件中要规定切面，且我遇见过6个切面都存在陈数的情况）

A2：这其实触及到了拓扑能带理论的核心逻辑：体态拓扑决定边界态。表面态（或边界态）来源于体态拓扑性质：拓扑材料的一个核心定理是：Bulk–Boundary Correspondence（体–边对应原理）。一个体态系统的拓扑不变量（如 Chern 数、𝑍2 指标）决定了其边界是否存在稳定的表面态。换句话说：表面态不是独立存在的；它是体能带（bulk band）拓扑结构的“投影”或“表现形式”。所以计算二维表面态的第一步是：确定 bulk 能带及其拓扑不变量。

1️⃣ 从 DFT/Wannier90 得到 bulk 哈密顿矩阵 (wannier90_hr.dat)

2️⃣ WannierTools 读取 bulk 哈密顿量

3️⃣ 根据用户定义的表面切面 (surface plane)，对晶格进行投影

4️⃣ 构造 slab（超胞体）或半无限格林函数

5️⃣ 求解表面态或边缘态谱

虽然二维体系在物理空间中厚度极薄，但它依然是一个晶格周期性的二维平面。
在WannierTools的框架中，二维系统仍被视为一个二维晶体中的周期性布洛赫体，因此在数值模拟时可以“虚拟地”切割出不同的边界方向。

<img src="/img/wannier90的逻辑/bg-w1.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w2.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w3.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w4.png" style="width:100%; margin-bottom:5px;">


Q3：实际上vasp对接的是二维体系的能带计算，然后wannier构造wannier函数，但计算的又是三位体系，如何保证计算的物理合理性和数学合理性？

A3：
<img src="/img/wannier90的逻辑/bg-w5.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w6.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w7.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w8.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w9.png" style="width:100%; margin-bottom:5px;">


Q4: 我看到in文件中的CONTROL中可以选择是否计算bulkband_calc，结合你刚刚回答的结果，似乎一定要计算bulkband？

A5：
<img src="/img/wannier90的逻辑/bg-w11.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w12.png" style="width:100%; margin-bottom:5px;">

<img src="/img/wannier90的逻辑/bg-w13.png" style="width:100%; margin-bottom:5px;">