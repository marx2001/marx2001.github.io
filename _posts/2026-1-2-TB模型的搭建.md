---
layout: post
title: "基于对称性构造TB模型(n带紧束缚模型)"
subtitle: "Experience Sharing"
background: '/img/bg-sci-note.jpg'
categories: sci-note
permalink: /sci-note_posts/20260102-MagneticTB
---

## <center>心得体会</center>

这几天一直在琢磨wannier tools计算的边缘态是否正确，所以先用pythTB写了代码，用自己电脑计算边缘态，然后用同门的代码，改了改，计算角态，但是心里还是不踏实，于是琢磨怎么通过数学建模来构造紧束缚模
型，于是biying搜索关键词“构造紧束缚模型”，看到一篇知乎文章，推荐mageticTB，可以从磁群出发，用mathematica来构造n带的TB模型，上手尝试。自己尝试了大概5个小时，终于看官方文档把代码写了出来，但是
卡在了wyckoff位置上，我认为c位置有2个wyckoff position，都要写上，原因是磁矩方向不同，但是看到一篇近期的PRL刚好讲了我这个体系的TB模型构造，并在支撑材料给出了他的magneticTB代码，发现他只用了1个，早知道先搜索文章了，但解决了无数报错，也算是积累经验，我的代码和这篇prl一样简洁，只是wyckoff position不一样，所以经过我的投影能带分析，我选择了考虑soc的情况下的6个轨道基组，dxy/dyz/dxz轨道，哈密顿量矩阵是12*12，所以是12带模型，一共有54个params。也就是说，e（在位能）t（跃迁项）r（soc），三个可以自由选择的参数，一共有54项，正常的2能带模型，或者四带模型，也就3个变量起步，也很少，但是我这个54个是不可能靠人力去逐项枚举，（其实3个变量也太多了，不限范围，不限整数分数，也是无限种可能），我不知道其他人怎么做的，但是咨询了一个大佬之后，可以通过mathematica导出基函数，然后用二分法或者梯度下降法或者其他方法与DFT和wannier能带作为对比，用python代码计算与DFT和Wannier能带的能量差来计算出最小的etr参数组合，这大概就是具体的流程。

我之前一直以为kdotp-symmetry包得到kp模型之后，需要傅里叶变换得到TB模型，还要把晶格模型镶嵌进TB模型中，这个过程未知数太多，全都是不会的（尽管MagneticTB也是一样，但毕竟有详尽的官方中文手册），但是MagneticTB似乎原理也是差不多，都是基于对称性来构造TB模型，我就没有强求必须用kp方法构造紧束缚模型。


## <center>步骤</center>

按照官网要求安装MagneticTB，安装mathematica 14.1中文版

构造12带模型的MagneticTB的mathematica文件我已经上传到了github，不能展示在此页面中，因为github在部署网页中会报错，无法部署任何网页。

然后用代码导出基函数的哈密顿量矩阵，再用python代码计算etr即可。